<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Home</title>

    <link rel="stylesheet" href="./homePage/styles.css" />
    <link rel="stylesheet" href="./css/bootstrap.min.css" />
    <!-- Add icon library -->
    <script src="http://code.jquery.com/jquery-1.12.1.min.js"></script>

    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Play" />
    <link href="//db.onlinewebfonts.com/c/31d6999b03b69180254d0999127e1bc8?family=UnpackW00-Fast" rel="stylesheet" type="text/css" />

    <link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@100;400&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" />

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

</head>

<body class="indexBody">
    <header>
        <div id="header_container">
            <div class="headerDiv">
                <h1 class="headerLogo">
                    <a href="#" onclick="displayHome()" class="a_logo"> <span style="color: #f17eb2">#</span>
                        <span style="color: #6bb2e2">K</span> <span style="color: #6bb2e2">e</span>
                        <span style="color: #6bb2e2">e</span> <span style="color: #6bb2e2">p</span>
                        <span style="color: #f17eb2">I</span> <span style="color: #f17eb2">t</span>
                        <span style="color: #7ec479">S</span> <span style="color: #7ec479">o</span>
                        <span style="color: #7ec479">r</span> <span style="color: #7ec479">t</span>
                        <span style="color: #7ec479">e</span> <span style="color: #7ec479">d</span>
                    </a>
                </h1>
            </div>
            <div class="navigationDiv">
                <nav>
                    <input type="checkbox" id="check">
                    <label for="check" class="checkbtn">
                        <i class="fas fa-bars"></i>
                    </label>
                    <ul class="">
                        <li><a href="#" onclick="displayHome()">Home</a></li>
                        <li><a href="#" onclick="displayGame()">Game</a></li>
                        <li><a href="#" onclick="Repository()">Education</a></li>
                        <li><a href="#" onclick="onSearch()">ImageSearch</a></li>
                        <li id="btnLogin">
                            <a id="aLogin" href="#" onclick="login()" class="button">Login</a>
                        </li>
                        <li id="btnAccount" class="dropdown"><a class="button" data-toggle="dropdown" href="#">Account
                                <span class="caret"></span></a>
                            <ul class="dropdown-menu">
                                <li><a href="#" onclick="onProfile()">Your Profile</a></li>
                                <li><a href="#" onclick="onLogout()">Logout</a></li>
                            </ul>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>
    <div class="iframe-container">
        <iframe id="centerFrame" onLoad="iframeLoad()" frameborder="0" width="100%" src="homePage/home.html"></iframe>
    </div>
    <div class="footer-dark" style="margin-top: -2%;">
        <footer>
            <div class="container">
                <div class="row">
                    <div class="col-md-6 item text">
                        <h3>
                            <a onclick="aboutUs()">About Us</a>
                        </h3>
                        <p>
                            We are a team of developers that is passionate about sustainability and our goal is to encourage people through entertainment and education.
                        </p>
                    </div>
                    <div class="col item social">
                        <h3>Follow us</h3>
                        <a href="#"><i class="icon ion-social-facebook"></i></a>
                        <a href="https://twitter.com/siazonchen"><i class="icon ion-social-twitter"></i></a>
                        <a href="https://github.com/siazon/GarbageSorting"><i class="icon ion-social-github"></i></a>
                        <a href="#">
                            <i class="icon ion-social-instagram">
                            </i>
                        </a>
                    </div>
                </div>
                <p class="copyright">KeepItSorted Â© 2022</p>
            </div>
        </footer>
    </div>
    <script>
        window.onload = function() {
            var token = localStorage.getItem("token");
            if (token != undefined && token.length > 0) {
                isLogin(true);
                console.log("token is ", $("#btnLogin"), token);

            } else {
                isLogin(false);
                console.log("token is null", $("#btnLogin"));
            }

        };
        window.addEventListener('message', function(e) {
            if (e.data.name != undefined && e.data.name.length > 0) {
                var token = localStorage.getItem("token");
                if (token.length > 0) {
                    isLogin(true);

                } else {
                    isLogin(false);
                }
            }
        }, false);

        function isLogin(flag) {
            // console.log('before:', $("#aLogin").text())
            // $("#aLogin").text("acount")
            // console.log('after:', $("#aLogin").text())
            if (flag) {

                $("#btnLogin").hide();
                $("#btnAccount").show();
            } else {
                $("#btnLogin").show();
                $("#btnAccount").hide();
            }
        }

        function onOpenMenu() {
            $('.offcanvas-collapse').toggleClass('open')
        }

        function iframeLoad() {
            document.getElementById("centerFrame").height =
                document.getElementById("centerFrame").contentWindow.document.body.scrollHeight;
        }

        function displayHome() {
            document.getElementById("centerFrame").src = "./homePage/home.html";
        }

        function displayGame() {

            document.getElementById("centerFrame").src = "./gamewelcome.html";
        }

        function displayStore() {
            document.getElementById("centerFrame").src =
                "./imagespage/store.html";
        }

        function onSearch() {
            document.getElementById("centerFrame").src = "./imagespage/index.html";
            document.getElementById("centerFrame").height = 750;
        }

        function Repository() {
            document.getElementById("centerFrame").src =
                "InformationPage/InfoPage.html";
        }

        function aboutUs() {
            document.getElementById("centerFrame").src = "about.html";
        }

        function login() {
            document.getElementById("centerFrame").src = "./loginPage/index.html";
        }

        function onProfile() {

            var userType = localStorage.getItem("userType");
            if (userType != undefined && userType.length > 0 && userType == "user") {
                document.getElementById("centerFrame").src = "./rankingpage/index.html";
            } else {
                console.log("imagespage")
                document.getElementById("centerFrame").src = "./userList.html";
                console.log("url:", document.getElementById("centerFrame").src)
            }

        }

        function onLogout() {
            localStorage.setItem("token", "");
            localStorage.setItem("userType", "user");
            isLogin(false);
            document.getElementById("centerFrame").src = "./homePage/home.html";
        }
    </script>

</body>

</html>
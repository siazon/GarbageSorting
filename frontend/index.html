<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>Home</title>

    <link rel="stylesheet" href="homePage/styles.css" />
    <!-- Add icon library -->

    <script src="http://code.jquery.com/jquery-1.12.1.min.js"></script>
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css" />

    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Play" />
    <link href="//db.onlinewebfonts.com/c/31d6999b03b69180254d0999127e1bc8?family=UnpackW00-Fast" rel="stylesheet" type="text/css" />

    <link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@100;400&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" />
    <script src="./JS/Util.js"></script>
</head>

<body>
    <header>
        <div id="container">
            <div class="headerDiv">
                <h1 class="headerLogo">
                    <a href="#" onclick="displayHome()" class="a_logo">
                        <span style="color: #f17eb2">#</span>
                        <span style="color: #6bb2e2">K</span>
                        <span style="color: #6bb2e2">e</span>
                        <span style="color: #6bb2e2">e</span>
                        <span style="color: #6bb2e2">p</span>
                        <span style="color: #f17eb2">I</span>
                        <span style="color: #f17eb2">t</span>
                        <span style="color: #7ec479">S</span>
                        <span style="color: #7ec479">o</span>
                        <span style="color: #7ec479">r</span>
                        <span style="color: #7ec479">t</span>
                        <span style="color: #7ec479">e</span>
                        <span style="color: #7ec479">d</span>
                    </a>
                </h1>
            </div>

            <div class="navigationDiv">
                <nav>
                    <ul>
                        <li><a href="#" onclick="displayHome()">Home</a></li>
                        <li><a href="#" onclick="displayGame()">Game</a></li>
                        <li><a href="#" onclick="Repository()">Education</a></li>
                        <li><a href="#" onclick="aboutUs()">About Us</a></li>
                        <li>
                            <a href="#" id="btnLogin" onclick="login()" class="button">Login</a>
                        </li>
                        <li>
                            <a href="#" onclick="onInvite()" class="button">Invite</a>
                        </li>
                    </ul>
                </nav>
            </div>

            <!-- <div class="buttonDiv">
          <a href="#" id="btnLogina" onclick="login()" class="button">Login</a>
            </div>
        </div> -->
    </header>
    <section class="select">
        <iframe id="centerFrame" onload="this.width=screen.width;this.height=screen.height;" src="homePage/home.html"></iframe>
    </section>
    <div class="footer-dark">
        <footer>
            <div class="container">
                <div class="row">
                    <div class="col-md-6 item text">
                        <h3>About Us</h3>
                        <p>
                            We are a team of developers that is passionate about sustainability and our goal is to encourage people through entertainment and education.
                        </p>
                    </div>

                    <div class="col item social">
                        <h3>Follow us</h3>
                        <a href="#"><i class="icon ion-social-facebook"></i></a
              ><a href="#"><i class="icon ion-social-twitter"></i></a
              ><a href="#"><i class="icon ion-social-snapchat"></i></a
              ><a href="#"><i class="icon ion-social-instagram"></i></a>
                    </div>
                </div>
                <p class="copyright">KeepItSorted © 2022</p>
            </div>
        </footer>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="gameover" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLongTitle">Game Over</h5>
                    <!-- <button type="button" class="close" data-dismiss="modal" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button> -->
                </div>
                <div class="modal-body">
                    <p id="msgscore" class="lead text-muted">Please send this URL to your friend for signup:</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="onCopy()">
          Copy
        </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        async function getQty() {
            var url = "/js/config.json";
            var _this = this;
            host = "http://127.0.0.1:8082";
            await fetch(host + "/fileList/", {
                    method: "GET",
                    headers: {
                        // token: localStorage.getItem("token"),
                    },
                })
                .then((response) => response.json())
                .then((json) => {
                    console.log(json);
                    localStorage.setItem("recycleQty", json[0]);
                    localStorage.setItem("organicQty", json[1]);
                    localStorage.setItem("trashQty", json[2]);
                });
        }
        window.onload = function() {
            var token = localStorage.getItem("token");
            if (token.length > 0) {
                $("#btnLogin").val("Logout");
                console.log("token is ", $("#btnLogin").val(), token);
            } else {
                console.log("token is null");
            }
            getQty();
        };

        function onInvite() {
            var url = "/js/config.json";
            var _this = this;
            host = "http://127.0.0.1:8082";
            fetch(host + "/GetInviteCode/", {
                    method: "GET",
                    headers: {
                        token: localStorage.getItem("token"),
                    },
                })
                .then((response) => response.json())
                .then((json) => {
                    var url = window.top.document.URL
                    url = url.substr(0, url.length - 1)
                    alert("Invite Url already on clipboard.\n Please send this URL to your friend for signup");
                    //TODO
                    //  showGameOver(url + "loginPage/index.html?code=" + json.code);
                    copyToClip(url + "loginPage/index.html?code=" + json.code);
                    console.log(json, url);
                });
        }

        function copyToClip(content) {
            var aux = document.createElement("input");
            aux.setAttribute("value", content);
            document.body.appendChild(aux);
            aux.select();
            document.execCommand("copy");
            document.body.removeChild(aux);
            // if (message == null) {
            //     alert("复制成功");
            // } else {
            //     alert(message);
            // }
        }

        function showGameOver(url) {
            console.log(url)
            $("#msgscore").append(url);
            $("#gameover").modal("show");
        }

        function displayHome() {
            document.getElementById("centerFrame").src = "./homePage/home.html";
        }

        function displayGame() {


            document.getElementById("centerFrame").src = "./gamewelcome.html";
        }

        function Repository() {
            document.getElementById("centerFrame").src =
                "InformationPage/InfoPage.html";
        }

        function aboutUs() {
            document.getElementById("centerFrame").src = "./imagespage/upload.html"; //"about.html";
        }

        function login() {
            document.getElementById("centerFrame").src = "./loginPage/index.html";
        }
    </script>
</body>

</html>